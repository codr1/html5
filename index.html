<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>WebFit</title>
        <meta charset="utf-8">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <link rel="manifest" href="site.webmanifest">
        <link rel="apple-touch-icon" href="icon.png">
        <!-- Place favicon.ico in the root directory -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="node_modules/bootstrap-social/bootstrap-social.css" >
        <link rel="stylesheet" href="node_modules/font-awesome/css/font-awesome.css" >
        <link href="//netdna.bootstrapcdn.com/bootswatch/3.1.0/superhero/bootstrap.min.css" rel="stylesheet">

        <style>
            .centered-form .panel{
                background: rgba(255, 255, 255, 0.8);
                box-shadow: rgba(0, 0, 0, 0.3) 20px 20px 20px;
                padding: 2px;
            }

            .centered-form{
                margin-top: 60px;
            }

            body{
                background: url("img/turquoise-girl.jpg") no-repeat center fixed;
                background-size: cover;
            }

            .centered-form .panel{
                background: rgba(255, 255, 255, 0.8);
                box-shadow: rgba(0, 0, 0, 0.3) 20px 20px 20px;
            }

            .centered-form{
                margin-top: 60px;
            }
        </style>

    </head>
    <body>


        <script>
            // Validate S&F FB token
            function postFBAuthRequest( facebookToken ) {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                    if( this.readyState == 4 && this.status == 200 ) {
                        alert( this.responseText );
                    }
                };

                let object = {};
                object.backend = "facebook";
                object.token = facebookToken;
                object.grant_type = "convert_token";
                object.client_id = "9Sr60XFG3FzmauXIdSZO8rIKogXkB5NPlwFBjtFz";

                xhttp.open( "POST", "https://api.styleandfit.com/oauth/convert-token");
                xhttp.setRequestHeader( "Content-Type", "application/json" );
                xhttp.send( JSON.stringify( object ) );
            }

            // Validate S&F User/Pass Login
            function postUserNameAuthRequest( userName, password ) {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                    if( this.readyState == 4 && this.status == 200 ) {
                        alert( this.responseText );
                    }
                };


                let object;
                object.grant_type = "password";
                object.client_id = "9Sr60XFG3FzmauXIdSZO8rIKogXkB5NPlwFBjtFz";
                object.username = userName;
                object.password = password;

                //xhttp.open( "POST", "https://api.styleandfit.com/oauth/convert-token");
                xhttp.send();

            }
        </script>

        <!-- Load the facebook API! -->
        <script>
            window.fbAsyncInit = function() {
                FB.init({
                    appId            : '1455738771180548',
                    autoLogAppEvents : true,
                    xfbml            : true,
                    version          : 'v2.10'
                });
                FB.AppEvents.logPageView();

                FB.getLoginStatus(function(response) {
                    statusChangeCallback(response);
                });
            };

            (function(d, s, id){
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) {return;}
                js = d.createElement(s); js.id = id;
                js.src = "https://connect.facebook.net/en_US/sdk.js";
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));


            function doFBLogin( ) {
               FB.login( function( response ){
                   if( response.status === 'connected' ){
                       postFBAuthRequest( response.authResponse.accessToken );
                       //window.location.href = "enterData.html";
                   } else {
                       alert( "Facebook login failed." );
                   }
               }, {scope: 'public_profile,email'});
            }

            function statusChangeCallback( response ){
                if( response ) {
                    console.log( "In status change callback: " + response );



                    //alert( response );
                    //TODO: here we can just navigate to the next page.
                } else {
                    //alert( 'Login expired.' );
                }
            }
        </script>

        <script>
            function emailLogin() {
                alert( "Ordinarily you would be in for some extreme vetting.  Today is your lucky day.  Come right in" );
                window.location.href = "enterData.html";
            }

        </script>

        <!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        <p>Hello world! S&F in HTML5.</p>
        <script src="js/vendor/modernizr-3.5.0.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-3.2.1.min.js"><\/script>')</script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>

        <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
        <script>
            window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
            ga('create','UA-XXXXX-Y','auto');ga('send','pageview')
        </script>
        <script src="https://www.google-analytics.com/analytics.js" async defer></script>

        <div class="container" style="height:100vh">
            <div class="row centered-form">
                <div class="col-xs-12 col-sm-8 col-md-4 col-sm-offset-2 col-md-offset-4">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="background-color: rgba(0,0,0,0.25)">
                            <h3 class="panel-title"><strong>Discover your &nbsp; STYLE&FIT</strong></h3>
                        </div>
                        <div class="panel-body" style="background-color: rgba( 1,1,1,0.15)">

                            <form role="form" method="GET" onsubmit="return emailLogin();" action="enterData.html">

                                <div class="row">
                                    <div class="form-group col">
                                        <input type="email" name="user_name" class="form-control input-sm" placeholder="Email address" required>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="form-group col">
                                        <input type="password" name="password" class="form-control input-sm" placeholder="Password" required>
                                    </div>
                                </div>

                                <div class="row col form-group center-block">
                                    <input type="submit" value="LOGIN" class="btn btn-info btn-block" style="background-color: rgb( 64, 224, 208 )">
                                </div>

                            </form>

                            <div class="row col form-group center-block">
                                <h1 class="text-center text-white" style="white-space: nowrap">
                                    <del>&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </del>
                                    OR
                                    <del>&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </del>
                                </h1>
                            </div>

                            <div class="row social-buttons">
                                <div class="form-group center-block col">

                                    <a class="btn btn-block btn-social btn-md btn-facebook" style="color:#fff;" onclick="doFBLogin();">
                                        <span class="fa fa-facebook" ></span> Sign in with Facebook
                                    </a>
                                </div>
                            </div>

                            <div class="row social-buttons">
                                <div class="form-group center-block col">
                                    <a class=" btn btn-block btn-social btn-md btn-google" style="color:#fff" onclick="">
                                        <span class="fa fa-google"></span> Sign in with Google
                                    </a>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>


    </body>
</html>
